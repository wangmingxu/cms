angular.module("starter.controllers",[]).controller("navCtrl",function(e,t,i,n){$(document).on("click",".nav_item li",function(e){e.preventDefault(),$(".nav_item li").removeClass("active"),$(e.currentTarget).addClass("active")})}).controller("planEntranceCtrl",function(e,t,i,n){e.enterAdvPlan=function(){i.path("tab/planList/1")},e.enterArticlePlan=function(){i.path("tab/planList/2")}}).controller("planListCtrl",function(e,t,i,n,a){e.planType=a.planType,e.toAddPlan=function(){i.path("tab/addPlanStep1/"+e.planType)};var c=n+"cms/showPlan/query/showPlans";t({method:"GET",url:c}).then(function(t,i,n,a){console.log(t.data),e.list=t.data.model.showPlanDTOList},function(e,t,i,n){console.log(e)})}).controller("picMaterialCtrl",function(e,t,i,n,a,c){var o=n+"cms/material/query/materials?materialType=1";t({method:"GET",url:o}).then(function(t,i,n,a){console.log(t.data),e.list=t.data.model.materialDTOList},function(e,t,i,n){console.log(e)})}).controller("articleMaterialCtrl",function(e,t,i,n,a,c){var o=n+"cms/material/query/materials?materialType=2";t({method:"GET",url:o}).then(function(t,i,n,a){console.log(t.data),e.list=t.data.model.materialDTOList},function(e,t,i,n){console.log(e)})}).controller("addPlanStep1Ctrl",function(e,t,i,n,a,c,o,l){e.start_time=new Date,e.planType=l.planType,window.cache&&(console.log("存在缓存"),e.planName=cache.get("planName"),e.start_time=cache.get("start_time"),e.end_time=cache.get("end_time"),e.planType=cache.get("planType"),e.priority=cache.get("priority"),e.admin_isSelect=JSON.parse(cache.get("admin_isSelect")),e.serviceArea_selectIndex=JSON.parse(cache.get("serviceArea_selectIndex")),e.serviceArea_isSelect=JSON.parse(cache.get("serviceArea_isSelect")));var r=n+"cms/showPlan/allRegion";t({method:"GET",url:r}).then(function(t,i,n,a){console.log(t.data),e.administration_area=t.data.model.provinceDTOList,e.service_area=t.data.model.serviceAreaVOList},function(e,t,i,n){console.log(e)}),e.cacheIpt=function(t){var i=e.start_time,n=e.end_time,a=JSON.stringify(e.admin_isSelect),c=JSON.stringify(e.serviceArea_selectIndex),o=JSON.stringify(e.serviceArea_isSelect);t.put("planName",e.planName),t.put("start_time",i),t.put("end_time",n),t.put("planType",e.planType),t.put("priority",e.priority),t.put("admin_isSelect",a),t.put("serviceArea_selectIndex",c),t.put("serviceArea_isSelect",o)},e.toStep2=function(){window.cache?(cache.removeAll(),e.cacheIpt(cache),c.go("tab.planEntrance.addPlanStep2")):(window.cache=a("addPlan"),e.cacheIpt(cache),c.go("tab.planEntrance.addPlanStep2"))},e.admin_isSelect=[],e.serviceArea_selectIndex=[],e.select_item=function(t){var i=e.admin_isSelect.indexOf(e.administration_area[t].provinceID);i==-1?e.admin_isSelect.push(e.administration_area[t].provinceID):e.admin_isSelect.splice(i,1)},e.AreaClass=function(t){var i=e.admin_isSelect.indexOf(e.administration_area[t].provinceID);if(i!=-1)return"area_name_active"},e.ensure_area=function(){console.log(e.serviceArea_isSelect)},e.cancel=function(){e.admin_isSelect=[],e.serviceArea_selectIndex=[],e.serviceArea_isSelect=[]},e.adminAreaName_select=function(t){var i=e.admin_isSelect.indexOf(t);return i!=-1},e.del_adminArea=function(t){var i=e.admin_isSelect.indexOf(t);e.admin_isSelect.splice(i,1)},e.del_serviceArea=function(t){e.serviceArea_selectIndex[t]=!1},e.$watch("serviceArea_selectIndex",function(){e.serviceArea_isSelect=[],e.serviceArea_selectIndex.map(function(t,i){t&&e.serviceArea_isSelect.push(e.service_area[i].provinceId)})},!0),e.serviceAreaName_select=function(t){var i=e.serviceArea_isSelect.indexOf(t);return i!=-1}}).controller("addPlanStep2Ctrl",function(e,t,i,n,a,c){e.planName=cache.get("planName"),e.getPic=function(){var i=n+"MaterialList";Mock.mock(i,{"list|6-10":[{"id|+1":1,picUrl:"img/defaultimg.png","materialName|1":["素材名素材名素素材名素材名1...","素材名素材名素素材名素材名2...","素材名素材名素素材名素材名3...","素材名素材名素素材名素材名4..."]}]}),t({method:"GET",url:i}).then(function(t,i,n,a){e.picList=t.data.list},function(e,t,i,n){console.log(e)})},e.getPic(),e.getResource=function(){e.checked_resource=[];var i=n+"cms/resource/query/resource";Mock.mock(i,{"list|1-10":[{"id|+1":1,resourcePositionName:"PC首页焦点图轮播","platform|1":[1,2,3,4],pixelHeight:760,pixelWidth:450,size:"128KB"}]}),t({method:"GET",url:i}).then(function(t,i,n,a){console.log(t.data),e.resourceList=t.data.list},function(e,t,i,n){console.log(e)})},e.resource_ensure=function(){e.resourceList.map(function(t,i){t.isChecked&&(t.picList=e.picList,e.checked_resource.push(t))})},e.show_picList=function(t){e.temp_index=t,e.temp_picList=e.checked_resource[t].picList},e.select_pic=function(t){e.temp_picList[t].isSelect?e.temp_picList[t].isSelect=!1:e.temp_picList[t].isSelect=!0},e.SelectClass=function(t){if(e.temp_picList[t].isSelect)return"material_item_active"},e.judge_hasSelect=function(t){var i=0;return e.checked_resource[t].picList.map(function(e,t){e.isSelect&&i++}),i>0},e.pic_next=function(){e.temp_picList_next=[],e.temp_picList.map(function(t,i){t.isSelect&&e.temp_picList_next.push(t)}),console.log(e.temp_picList_next),$("#selectPic_Modal").modal("hide"),$("#editPic_Modal").modal("show")},e.swapItems=function(e,t,i){return e[t]=e.splice(i,1,e[t])[0],e},e.move_up=function(t,i){0!=i&&e.swapItems(t,i,i-1)},e.move_down=function(t,i){i!=t.length-1&&e.swapItems(t,i,i+1)},e.pic_finish=function(){},e.getArticle=function(){var i=n+"MaterialList";Mock.mock(i,{"list|1-10":[{"id|+1":1,"title|1":["注册与审核","用户登录","用户注册"],previewUrl:"https://www.baidu.com/img/baidu_jgylogo3.gif"}]}),t({method:"GET",url:i}).then(function(t,i,n,a){e.articleList=t.data.list,console.log(e.articleList)},function(e,t,i,n){console.log(e)})},e.article_ensure=function(){console.log(e.articleList)},e.back=function(){a.go("tab.planEntrance.addPlanStep1")}}).controller("uploadpicCtrl",function(e,t,i,n,a){e.picList=[],e.delPic=function(t){e.picList.splice(t,1)},e.$watch("picList",function(){e.restCount=6-e.picList.length},!0),e.upload=function(){for(var t=new FormData,i=0;i<e.picList.length;i++)t.append("file"+i,e.picList[i].file),t.append("materialNameList",e.picList[i].title);t.append("targetUrl",e.targetUrl);var n="http://192.168.17.9:8088/cms/material/upload/pictures";$.ajax({url:n,type:"POST",data:t,async:!1,cache:!1,contentType:!1,processData:!1}).done(function(){$("#uploadFinish").modal("show"),a(function(){$("#uploadFinish").modal("hide")},800)}).fail(function(){$("#uploadFail").modal("show"),a(function(){$("#uploadFail").modal("hide")},800)})}}).controller("createArticleCtrl",function(e,t,i,n){UE.getEditor("editor");e.getContent=function(){var e=[];e.push("使用editor.getContent()方法可以获得编辑器的内容"),e.push("内容为："),e.push(UE.getEditor("editor").getContent()),alert(e.join("\n"))}}).controller("advResourceCtrl",function(e,t,i,n,a){e.platform=a.platform;var c=n+"cms/resource/query/resource";t({method:"GET",url:c}).then(function(t,i,n,a){console.log(t.data),e.list=t.data.model.resourcePositionDTOList},function(e,t,i,n){console.log(e)})});